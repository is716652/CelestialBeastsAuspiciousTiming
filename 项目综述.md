# 禽星盘式 - 项目综述

## 一、项目定位

**禽星盘式**是一款基于HarmonyOS（鸿蒙）的演禽术文化研习App，用于展示传统二十八宿演禽术的排盘体系。

**重要边界**：
- ✅ 文化研究工具，非命理占卜
- ✅ 方位推演，非"走失/占断"等敏感功能
- ⚠️ 敏感词规避：避免使用"命理"、"占卜"、"占断"、"走失"等词汇

---

## 二、技术栈

| 类型 | 技术 |
|------|------|
| 平台 | HarmonyOS (ArkTS) |
| 构建工具 | Hvigor |
| 编程语言 | ArkTS (TypeScript变体) |
| UI框架 | ArkUI |
| 数据存储 | rawfile JSON配置文件 |

**编译命令**：
```bash
cd d:\DevEcoStudioProjects\CelestialBeastsAuspiciousTiming
hvigorw assembleHap --no-daemon
```

---

## 三、核心页面

### 1. Splash.ets - 引导页
- 位置：`entry/src/main/ets/pages/Splash.ets`
- 功能：App启动引导页，6秒自动跳转或点击进入主页
- 背景图：`rawfile/splash_bg.jpg`

### 2. Index.ets - 主页（方位推演）
- 位置：`entry/src/main/ets/pages/Index.ets`
- 功能：
  - 双卡片入口（方位推演 / 演禽盘式）
  - 日期时辰选择
  - 十二宫通用含义推导
  - 方位结果展示

### 3. YanQinPanShi.ets - 演禽盘式（专业排盘）
- 位置：`entry/src/main/ets/pages/YanQinPanShi.ets`
- 功能模块：

| 模块 | 来源依据 | 功能 |
|------|----------|------|
| 三传四课 | 《禽星赋》 | 日禽→时禽→翻禽，四课定义 |
| 锁泊十二宫 | 《张良锁泊歌》 | 天地盘双层展示，上南下北 |
| 吞啖生克 | 演禽规则 | 禽星五行生克判断 |
| 飞伏动静 | 演禽规则 | 日禽/夜禽活动状态 |
| 禽机赋断语 | 《禽机赋》 | 得地失陷、特殊格局判断 |
| 星宿物象 | 《射覆玄机赋》 | 二十八宿对应物品类象 |

---

## 四、核心配置文件

### 1. yanqin_star_rules.json
- 位置：`entry/src/main/resources/rawfile/yanqin_star_rules.json`
- 内容：
  - `constellations_order`：二十八宿顺序
  - `constellations_full`：星宿详细信息（全称、五行、动物）
  - `year_star_rules`：年禽计算规则
  - `month_star_rules`：月禽计算规则
  - `day_star_rules`：日禽计算规则（七元甲子）
  - `hour_star_rules`：时禽计算规则
  - `huo_yao_rules`：活曜计算规则
  - `tun_dan`：吞啖配置
  - `ri_ye_qin`：日禽/夜禽分类

### 2. suo_bo_rules.json
- 位置：`entry/src/main/resources/rawfile/suo_bo_rules.json`
- 内容：
  - `qin_attributes`：禽星属性分类（日禽/夜禽/水禽/山禽/家禽）
  - `special_powers`：特殊能力（井木犴、心月狐克鸡等）
  - `taboos`：特殊禁忌
  - `movement_rules`：动静规则（虎狼不下水、蛟龙不上山）
  - `star_imagery`：星宿物象（出自《射覆玄机赋》）
  - `branch_environments`：十二地支环境对应
  - `suo_bo_ge`：张良锁泊歌格局断语

### 3. lost_items_config.json
- 位置：`entry/src/main/resources/rawfile/lost_items_config.json`
- 内容：用神速查表（方位推演用）

---

## 五、规则文档目录

位置：`规则/`

| 文件 | 内容 |
|------|------|
| 10. 禽星锁泊、与演禽盘式的分工.md | 锁泊概念与盘式区别 |
| 10.1 锁泊十二宫的排法图形.md | 上南下北布局规范 |
| 10.2 演禽盘式的布局图形.md | 天地盘隐性结构说明 |
| 12. 禽星赋.md | 三传四课定义、进退规则 |
| 13. 禽机赋.md | 禽星性情、喜忌、万物类象 |
| 14. 射覆玄机赋.md | 星宿物象对应 |

---

## 六、排盘体系说明

### 三传四课（依据《禽星赋》）

**三传**（时间轴）：
- 初传 = 日禽（背景/大环境）
- 中传 = 时禽（当前状态/我）
- 末传 = 翻禽（最终结果/他）

**四课**（空间维度）：
- 一课 = 日禽
- 二课 = 时禽（我）
- 三课 = 翻禽（他）
- 四课 = 活曜（变）

### 天地盘（隐性结构）

演禽术的天地盘是**隐性**的：
- **地盘** = 时禽（我/静）
- **天盘** = 翻禽（他/动）
- **人盘** = 活曜（变）

同一地支位可同时显示天盘、地盘、人盘信息。

### 锁泊十二宫布局

**上南下北**（术数盘标准）：
```
      巳    午    未    申    ← 顶行（南）
      辰   [中宫] [中宫]  酉
      卯   [中宫] [中宫]  戌
      寅    丑    子    亥    ← 底行（北）
```

---

## 七、注意事项

### ArkTS开发规范
1. **禁止对象字面量作为类型**：必须定义interface
2. **Builder内禁止const声明**：使用类成员或方法获取数据
3. **使用Map替代Record**：避免`arkts-no-obj-literals-as-types`错误

### 资源命名规范
- 文件名只能包含`[a-zA-Z0-9_]`，禁止使用短横线`-`

### 路由配置
- 添加新页面需同时修改：
  1. `main_pages.json`
  2. `EntryAbility.ets`（如果是启动页）

### 敏感词规避
- "走失" → "方位推演"
- "精断" → "精研"
- 避免：命理、占卜、占断

---

## 八、待扩展功能

1. **进退强弱判断**：根据《禽星赋》的进退规则
2. **节气得时判断**：星宿在不同节气的旺衰
3. **更多锁泊格局**：补充张良锁泊歌中的完整断语

---

## 九、版本信息

- 当前版本：开发中
- 最后更新：2026年1月
- 编译状态：BUILD SUCCESSFUL
