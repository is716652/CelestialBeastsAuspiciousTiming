# 星禽研习 - JSON数据文件解读

## 项目概述

**星禽研习** 是一款基于传统演禽术（二十八宿体系）的国学研习工具。本项目将演禽术的核心算法（年禽、月禽、日禽、时禽）和断语规则完全数据化，以 JSON 配置驱动，便于后续扩展至**演禽盘式**和**禽星锁泊十二宫**等高级功能。

---

## 项目结构

```
CelestialBeastsAuspiciousTiming/
├── AppScope/                                # 应用级配置
│   ├── resources/base/
│   │   ├── element/string.json              # 应用名称：星禽研习
│   │   └── media/layered_image.json         # 应用图标配置
│   └── app.json5
├── entry/
│   └── src/main/
│       ├── ets/pages/Index.ets              # 主页面（排盘UI与算法）
│       └── resources/rawfile/               # 核心数据文件
│           ├── calendar/                    # 万年历数据（17个JSON）
│           ├── yanqin_star_rules.json       # ⭐ 四禽计算规则（核心）
│           ├── lost_items_config.json       # 用神配置（象类→星宿映射）
│           ├── lost_items_rules.json        # 断语规则库（132条）
│           ├── yanqin_meta_config.json      # 元配置（汇总）
│           └── yanqin_knowledge_15x.json    # 15.x 高阶规则研习知识库
├── 规则/                                     # 演禽术原始规则文档
│   ├── 2. 起年禽诀.md
│   ├── 3. 起月禽诀.md
│   ├── 4. 起日禽诀.md
│   ├── 5. 起时禽诀.md
│   └── ...
└── hvigor/                                   # 构建配置
```

---

## JSON 文件总览

| 文件名 | 用途 | 条目数 |
|--------|------|--------|
| `yanqin_star_rules.json` | 四禽（年/月/日/时禽）计算规则 | - |
| `lost_items_config.json` | 用神配置（13种象类→星宿映射） | 13条 |
| `lost_items_rules.json` | 断语规则库（星宿在地支） | 132条 |
| `yanqin_knowledge_15x.json` | 15.10~15.18 高阶规则的研习提示配置 | 若干标签 |
| `calendar/*.json` | 万年历数据（1900-2061） | 17个文件 |
| **`QiYaoUtils.ets`** | **七曜总断算法（16.1规则）** | **28宿−7类映射** |
| **`BaoYiZhuanUtils.ets`** | **宝义专日算法（15.19规则）** | **5级评估+臣犯君** |
| **`StarEventRulesUtils.ets`** | **二十八宿用事规则（规划中）** | **按星宿与事体映射吉凶等级** |

---

## 1. 万年历数据 `calendar/`

### 数据范围
- **时间跨度**：1900年 - 2061年（162年）
- **文件数量**：17个JSON文件
- **存储路径**：`entry/src/main/resources/rawfile/calendar/`
- **单文件大小**：约 1.6MB（最后一个文件约 167KB，仅含2年数据）

### 文件命名规则
| 文件名 | 年份范围 |
|--------|----------|
| calendar_data_0001.json | 1900-1909 |
| calendar_data_0002.json | 1910-1919 |
| ... | ... |
| calendar_data_0017.json | 2060-2061 |

### 文件选择逻辑

根据用户输入的公历年份，计算对应的文件编号：

```typescript
function getFileIndex(year: number): string {
  const index = Math.floor((year - 1900) / 10) + 1;
  return index.toString().padStart(4, '0');
}
```

### 数据结构

每条记录代表一天的完整信息：

```json
{
  "date": "2060-02-04",
  "year": 2060,
  "month": 2,
  "day": 4,
  "lunar_year": 2060,
  "lunar_month": 1,
  "lunar_day": 3,
  "zodiac": "龙",
  "year_gan": "庚",
  "year_zhi": "辰",
  "month_gan": "戊",
  "month_zhi": "寅",
  "day_gan": "丁",
  "day_zhi": "未",
  "week_day": 2,
  "week_name": "星期三",
  "is_holiday": 0,
  "holiday_name": "",
  "solar_term": "立春",
  "festivals": ""
}
```

### 字段说明

| 字段 | 类型 | 说明 | 演禽用途 |
|------|------|------|----------|
| `date` | string | 公历日期 | 用户输入 |
| `year_gan` | string | 年干 | 配合年禽计算 |
| `year_zhi` | string | 年支 | 配合年禽计算 |
| `day_gan` | string | 日干 | **关键**：用于判断甲子日 |
| `day_zhi` | string | 日支 | **关键**：配合日禽计算 |
| `lunar_month` | number | 农历月 | 配合月禽计算 |

---

## 2. 四禽计算规则 `yanqin_star_rules.json` ⭐核心

此文件是演禽术算法的**核心配置**，包含年禽、月禽、日禽、时禽的完整计算规则，为后续**演禽盘式**和**禽星锁泊十二宫**打下基础。

### 2.1 二十八宿基础数据

```json
"constellations_order": [
  "角", "亢", "氐", "房", "心", "尾", "箕",
  "斗", "牛", "女", "虚", "危", "室", "壁",
  "奎", "娄", "胃", "昴", "毕", "觜", "参",
  "井", "鬼", "柳", "星", "张", "翼", "轸"
]
```

**星宿详情**（共28宿）：

| 星宿 | 全名 | 七政属性 | 禽名 |
|------|------|----------|------|
| 角 | 角木蛟 | 木 | 蛟 |
| 亢 | 亢金龙 | 金 | 龙 |
| 氐 | 氐土貉 | 土 | 貉 |
| 房 | 房日兔 | 日 | 兔 |
| 心 | 心月狐 | 月 | 狐 |
| 尾 | 尾火虎 | 火 | 虎 |
| 箕 | 箕水豹 | 水 | 豹 |
| 斗 | 斗木獬 | 木 | 獬 |
| 牛 | 牛金牛 | 金 | 牛 |
| 女 | 女土蝠 | 土 | 蝠 |
| 虚 | 虚日鼠 | 日 | 鼠 |
| 危 | 危月燕 | 月 | 燕 |
| 室 | 室火猪 | 火 | 猪 |
| 壁 | 壁水貐 | 水 | 貐 |
| 奎 | 奎木狼 | 木 | 狼 |
| 娄 | 娄金狗 | 金 | 狗 |
| 胃 | 胃土雉 | 土 | 雉 |
| 昴 | 昴日鸡 | 日 | 鸡 |
| 毕 | 毕月乌 | 月 | 乌 |
| 觜 | 觜火猴 | 火 | 猴 |
| 参 | 参水猿 | 水 | 猿 |
| 井 | 井木犴 | 木 | 犴 |
| 鬼 | 鬼金羊 | 金 | 羊 |
| 柳 | 柳土獐 | 土 | 獐 |
| 星 | 星日马 | 日 | 马 |
| 张 | 张月鹿 | 月 | 鹿 |
| 翼 | 翼火蛇 | 火 | 蛇 |
| 轸 | 轸水蚓 | 水 | 蚓 |

### 2.2 年禽计算规则

**口诀来源**：《起年禽诀》

```json
"year_star_rules": {
  "base_year": 1984,
  "base_star": "虚",
  "note": "1984年甲子年，年禽为虚日鼠"
}
```

**算法**：
```typescript
// 年禽计算
const yearDiff = targetYear - 1984;
const starIndex = ((yearDiff % 28) + 28) % 28; // 处理负数
const yearStar = constellations_order[(10 + starIndex) % 28]; // 10是"虚"的索引
```

### 2.3 月禽计算规则

**口诀**："太阳用角木参头，太阴起室火星取，金心土胃水骑牛"

```json
"month_star_rules": {
  "element_to_start_star": {
    "日": "角",  // 太阳值年，正月起角
    "月": "室",  // 太阴值年，正月起室
    "火": "室",  // 火星值年，正月起室
    "金": "心",  // 金星值年，正月起心
    "土": "胃",  // 土星值年，正月起胃
    "水": "牛",  // 水星值年，正月起牛
    "木": "参"   // 木星值年，正月起参
  }
}
```

**算法**：
1. 计算当年年禽
2. 查年禽的七政属性（日/月/火/水/木/金/土）
3. 根据属性查正月起始星宿
4. 从起始星宿顺数到目标月

### 2.4 日禽计算规则（七元甲子）⭐最复杂

**口诀**："七元禽星会者稀，虚奎毕鬼翼氐箕"

这是演禽术的**核心算法**，基于"七元甲子"体系：
- **420天** 为一大循环（7元 × 60天）
- **60天** 为一元
- **15天** 为一将

```json
"day_star_rules": {
  "cycle_days": 420,
  "yuan_days": 60,
  "jiang_days": 15,
  
  "seven_yuan_heads": {
    "list": ["虚", "奎", "毕", "鬼", "翼", "氐", "箕"]
  },

  "four_generals": {
    "一元": ["虚", "张", "室", "轸"],
    "二元": ["奎", "亢", "胃", "房"],
    "三元": ["毕", "尾", "参", "斗"],
    "四元": ["鬼", "女", "星", "危"],
    "五元": ["翼", "壁", "角", "娄"],
    "六元": ["氐", "昴", "心", "觜"],
    "七元": ["箕", "井", "牛", "柳"]
  },

  "base_date": {
    "date": "1984-02-02",
    "yuan": 1,
    "jiang": 1,
    "star": "虚",
    "note": "1984年2月2日为一元甲子日，起虚日鼠"
  }
}
```

**算法**：
```typescript
// 日禽计算
const baseDate = new Date('1984-02-02');
const targetDate = new Date(dateString);
const diffDays = Math.floor((targetDate.getTime() - baseDate.getTime()) / (1000 * 60 * 60 * 24));

// 在420天大循环中的位置
const posInCycle = ((diffDays % 420) + 420) % 420;

// 确定第几元（0-6）
const yuanIndex = Math.floor(posInCycle / 60);

// 确定第几将（0-3）
const posInYuan = posInCycle % 60;
const jiangIndex = Math.floor(posInYuan / 15);

// 确定在该将内的第几天（0-14）
const dayInJiang = posInYuan % 15;

// 获取该将的起始星宿
const yuanNames = ["一元", "二元", "三元", "四元", "五元", "六元", "七元"];
const jiangStar = four_generals[yuanNames[yuanIndex]][jiangIndex];

// 从起始星宿顺数
const jiangStarIndex = constellations_order.indexOf(jiangStar);
const dayStarIndex = (jiangStarIndex + dayInJiang) % 28;
const dayStar = constellations_order[dayStarIndex];
```

### 2.5 时禽计算规则

**口诀**："日虚月鬼火寻箕，水毕木氐金奎位，土翼还从子位推"

```json
"hour_star_rules": {
  "element_to_start_star": {
    "日": "虚",  // 日属性的日子，子时起虚
    "月": "鬼",  // 月属性的日子，子时起鬼
    "火": "箕",  // 火属性的日子，子时起箕
    "水": "毕",  // 水属性的日子，子时起毕
    "木": "氐",  // 木属性的日子，子时起氐
    "金": "奎",  // 金属性的日子，子时起奎
    "土": "翼"   // 土属性的日子，子时起翼
  }
}
```

**算法**：
1. 计算当天日禽
2. 查日禽的七政属性
3. 根据属性查子时起始星宿
4. 从子时起始宿顺数到目标时辰

### 2.6 时辰对照表

```json
"hour_time_ranges": {
  "子": { "start": "23:00", "end": "01:00", "index": 0 },
  "丑": { "start": "01:00", "end": "03:00", "index": 1 },
  "寅": { "start": "03:00", "end": "05:00", "index": 2 },
  "卯": { "start": "05:00", "end": "07:00", "index": 3 },
  "辰": { "start": "07:00", "end": "09:00", "index": 4 },
  "巳": { "start": "09:00", "end": "11:00", "index": 5 },
  "午": { "start": "11:00", "end": "13:00", "index": 6 },
  "未": { "start": "13:00", "end": "15:00", "index": 7 },
  "申": { "start": "15:00", "end": "17:00", "index": 8 },
  "酉": { "start": "17:00", "end": "19:00", "index": 9 },
  "戌": { "start": "19:00", "end": "21:00", "index": 10 },
  "亥": { "start": "21:00", "end": "23:00", "index": 11 }
}
```

---

## 3. 用神配置 `lost_items_config.json`

**来源**：《鬼谷子二十八宿演禽走失全书歌》

用于映射"象类"（走失对象）到对应的"用神"（星宿）：

```json
"use_gods": [
  { "category": "男子", "star": "觜", "note": "男寻觜宿" },
  { "category": "女子", "star": "奎", "note": "妇寻奎" },
  { "category": "小儿/男孩", "star": "虚", "note": "小儿寻虚" },
  { "category": "小女/女孩", "star": "女", "note": "女寻蝠" },
  { "category": "牛", "star": "牛", "note": "牛寻牛星" },
  { "category": "马", "star": "星", "note": "马寻马" },
  { "category": "羊", "star": "鬼", "note": "羊寻羊兮" },
  { "category": "猪", "star": "室", "note": "猪寻猪" },
  { "category": "驴/骡", "star": "房", "note": "走失驴骡寻房宿" },
  { "category": "金银财宝", "star": "参", "note": "金银财宝是寻参" },
  { "category": "鸡", "star": "昴", "note": "失鸡寻昴" },
  { "category": "狗", "star": "娄", "note": "狗寻娄" },
  { "category": "衣服", "star": "柳", "note": "衣服寻柳定是真" }
]
```

### 用神对照表

| 象类（走失对象） | 用神（星宿） | 口诀 |
|------------------|--------------|------|
| 男子 | 觜（火猴） | 男寻觜宿 |
| 女子 | 奎（木狼） | 妇寻奎 |
| 小儿/男孩 | 虚（日鼠） | 小儿寻虚 |
| 小女/女孩 | 女（土蝠） | 女寻蝠 |
| 牛 | 牛（金牛） | 牛寻牛星 |
| 马 | 星（日马） | 马寻马 |
| 羊 | 鬼（金羊） | 羊寻羊兮 |
| 猪 | 室（火猪） | 猪寻猪 |
| 驴/骡 | 房（日兔） | 走失驴骡寻房宿 |
| 金银财宝 | 参（水猿） | 金银财宝是寻参 |
| 鸡 | 昴（日鸡） | 失鸡寻昴 |
| 狗 | 娄（金狗） | 狗寻娄 |
| 衣服 | 柳（土獐） | 衣服寻柳定是真 |

---

## 4. 断语规则库 `lost_items_rules.json`

**来源**：《孙伯陵秘传走失神书》

### 概述
- **规则数量**：132条（11个用神 × 12地支）
- **键名格式**：`{星宿名}在{地支}`，如 `觜星在子`、`奎宿在丑`

### 数据结构

```json
"meta": {
  "schema": {
    "text": "原文断语全文",
    "category": "分类标签（人物-男子、动物-马、财物-金帛等）",
    "direction": "方位信息（正北、东北方、西南方等）",
    "distance": "距离信息（九里远、三十里内、百里外等）",
    "environment": "环境/场景（水边、河边、寺边、树林中等）",
    "informant": "报信人（打鱼人、僧人、妇人、铁匠人等）",
    "time_hint": "时间提示（第三日巳时、十日不回、三日内等）"
  }
},
"rules": {
  "觜星在子": {
    "text": "觜星在子，男子穿两色衣物，圆脸、面黑、身短...",
    "category": "人物-男子"
  },
  ...
}
```

### 分类统计

| 分类 | 用神星宿 | 规则数量 |
|------|----------|----------|
| 人物-男子 | 觜 | 12条 |
| 人物-女子 | 奎、女 | 24条 |
| 人物-小儿 | 虚 | 12条 |
| 动物-马 | 星 | 12条 |
| 动物-牛 | 牛 | 12条 |
| 动物-驴骡 | 房 | 12条 |
| 动物-羊 | 鬼 | 12条 |
| 动物-猪 | 室 | 12条 |
| 财物-金帛 | 参 | 12条 |
| 物品-衣服 | 柳 | 12条 |

---

## 5. 15.x 高阶规则知识库 `yanqin_knowledge_15x.json`

用于承载 15.10~15.18 中适合“研习提示化”的时间趋势与盘面结构规则，供 Index 页和 YanQinPanShi 页生成中性、安全的标签卡片。

- 文件路径：`entry/src/main/resources/rawfile/yanqin_knowledge_15x.json`
- 主要结构：
  - `time_trend`：基于万年历计算的时间趋势标签（十恶大败日、天地荒芜日、罗天大进退日、六甲进退伏起始日、将军箭方、时中将星）
  - `pan_risk`：基于实际盘面的凶煞研习标签（无头星结构、六恶/大煞星组、刑害刀砧/汤火方、空亡/寡亡星组）
- 与规则文档的对应关系：
  - `time_trend.ten_evil` → 《15.10 活断  十恶大败日》
  - `time_trend.huang_wu` → 《15.12 活断  天地荒芜-十二月天地荒芜大凶日》
  - `time_trend.luotian` / `time_trend.general_arrow` / `time_trend.shi_zhong_jiangxing` → 《15.18 活断   李广将军箭-罗天大退日-大罗天大进日-进神退神时-时中将星》
  - `time_trend.sixjia` → 《15.17 活断   六甲进退神》
  - `pan_risk.liu_e_da_sha` → 《15.13 活断  禽中华盖方-六恶禽日-大煞六凶日》
  - `pan_risk.wu_tou` → 《15.14 活断  七日凶星诀-七元无头星》
  - `pan_risk.xinghai_tanghuo` → 《15.15 活断  灭没煞-百祸禽-刑害刀砧汤火-暗金伏断日时-伏断时》
  - `pan_risk.kong_wang_group` → 《15.16 活断   空亡体系_禽中大空亡-旬中空亡-截路空亡-六甲空亡》

> 说明：为控制 JSON 体积、防止内存压力，当前仅选取 15.10~15.18 中少量“标签级”规则，15.1~15.9 的大部分内容仍通过其他 JSON 或规则文档分阶段整合。

---

## 6. 七曜总断工具类 `QiYaoUtils.ets` ⭐新增

### 概述
- **文件位置**：`entry/src/main/ets/utils/QiYaoUtils.ets`
- **规则来源**：《16.1 专题占 七曜总断与事体适配法则.md》
- **核心功能**：将28宿分为7类（日月水木金土火），提供事体适配决策

### 七曜分类表

| 七曜类型 | 别名 | 性质 | 包含星宿 | 适宜事体 | 颜色 |
|----------|------|------|----------|----------|------|
| 日曜 | 喜宿 | 光明速成 | 虚、昴、星、房 | 求财、开市、嫁娶、出行 | `#ff9800` |
| 月曜 | 善宿 | 柔和圆满 | 危、毕、心、张 | 埋葬、行商、百事皆宜 | `#4caf50` |
| 水曜 | 弱宿 | 阴柔怩懦 | 箕、轸、参、壁 | 无 | `#9e9e9e` |
| 木曜 | 文宿 | 文昌贵气 | 角、奎、斗、井 | 求名、考试、出任、造宅 | `#2196f3` |
| 金曜 | 威宿 | 威权肃杀 | 亢、娄、牛、鬼 | 征伐、上官、捕盗 | `#f44336` |
| 土曜 | 怒宿 | 沉滞官非 | 胃、柳、氐、女 | 无 | `#795548` |
| 火曜 | 燥宿 | 炎上躁动 | 觜、室、尾、翼 | 埋葬 | `#e91e63` |

### 核心接口

```typescript
// 1. 获取七曜类型
export function getQiYaoTypeFromStar(star: string): QiYaoType | null;

// 2. 获取七曜完整信息
export function getQiYaoInfo(type: QiYaoType): QiYaoInfo;

// 3. 判断事体适配
export function isStarSuitableForEvent(star: string, eventName: string): SuitabilityResult;

// 4. 获取事体建议
export function getEventSuggestion(eventName: string): EventSuggestion | null;

// 5. 获取所有事体类型
export function getAllEventTypes(): string[];
```

### 事体适配示例

| 事体 | 首选七曜 | 次选七曜 | 禁忌七曜 | 解释 |
|------|----------|----------|----------|------|
| 嫁娶纳妓 | 日曜 | 月曜 | 金曜、水曜 | 日喜宿最佳，金威宿主刑伤 |
| 埋葬安葬 | 月曜、火曜 | - | 日曜、水曜 | 月善宿最吉，水弱宿主盗主凶 |
| 求名考试 | 木曜 | 日曜 | 水曜、土曜 | 木文宿文昌贵气，水弱宿主失败 |
| 上官赴任 | 金曜、木曜 | 日曜 | 水曜、土曜 | 金威宿主权威，土怒宿遇官符 |
| 行商贸易 | 月曜 | 日曜 | 水曜、土曜 | 月善宿柔和顺遂，水弱宿主失败被盗 |
| 造宅修建 | 木曜 | 月曜 | 火曜、水曜 | 木文宿主生发利建造，火燥宿主火灾 |

---

## 7. 宝义专日工具类 `BaoYiZhuanUtils.ets` ⭐新增

### 概述
- **文件位置**：`entry/src/main/ets/utils/BaoYiZhuanUtils.ets`
- **规则来源**：《15.19 活断 宝义专日与制伐日断法.md》
- **核心功能**：根据日干评级时间能量（宝义专制伐5级），检查臣犯君凶象

### 五级日分类

| 等级 | 日干 | 品质 | 描述 | 适宜事体 | 颜色 | Emoji |
|------|------|------|------|----------|---------|-------|
| 宝日 | 戊、己 | 优秀 | 如珍宝，百事皆宜 | 造葬、嫁娶、上官、开业 | `#4caf50` | 💎 |
| 义日 | 丙、丁 | 良好 | 主道义、合作 | 签约、结盟、求医 | `#2196f3` | 🤝 |
| 专日 | 壬、癸 | 良好 | 专一成就，事有专功 | 开业、动土、求名 | `#ff9800` | 🎯 |
| 制日 | 庚、辛 | 中性 | 受制约，需谨慎 | 小事可用，大事不宜 | `#9e9e9e` | ⚠️ |
| 伐日 | 甲、乙 | 不良 | 主征伐、破坏 | 无 | `#f44336` | ❌ |

### 臣犯君检查

**原理**：日干克岁干，为臣犯君，主以下犯上、损人丁、官非牢狱。

**五行相克关系**：
- 木克土：甲乙日遇戊己年
- 火克金：丙丁日遇庚辛年
- 土克水：戊己日遇壬癸年
- 金克木：庚辛日遇甲乙年
- 水克火：壬癸日遇丙丁年

### 核心接口

```typescript
// 1. 获取日级别
export function getDayLevelByGan(dayGan: string): DayLevel;

// 2. 获取日级别信息
export function getDayLevelInfo(level: DayLevel): DayLevelInfo;

// 3. 检查臣犯君
export function checkChenFanJun(dayGan: string, yearGan: string): ChenFanJunResult;

// 4. 综合评估吉凶
export function evaluateDayQuality(dayGan: string, yearGan: string): DayQualityEvaluation;
```

### 综合评估逻辑

| 情况 | 最终品质 | 建议 |
|------|----------|------|
| 宝日 + 无臣犯君 | 优秀 | 宝日大吉，百事皆宜 |
| 义日 + 无臣犯君 | 良好 | 义日吉利，主道义合作 |
| 专日 + 无臣犯君 | 良好 | 专日吉利，事有专功 |
| 伐日 + 无臣犯君 | 不良 | 伐日大凶，百事忌用 |
| **宝/义/专日 + 臣犯君** | **不良** | **吉神被制，反凶！建议改日** |
| **伐日 + 臣犯君** | **不良** | **极凶之日，百事不宜** |

---

## 8. 智能择日助手 `SmartDateSelector.ets` ⭐新增

### 概述
- **文件位置**：`entry/src/main/ets/pages/SmartDateSelector.ets`
- **核心功能**：综合七曜总断和宝义专日两套规则，自动筛选吉日

### 评分算法

| 评分项 | 分值 | 说明 |
|----------|------|------|
| 基础分 | 50 | 所有日子起始分 |
| 七曜首选 | +30 | 事体首选七曜匹配 |
| 七曜次选 | +15 | 事体次选七曜匹配 |
| 七曜禁忌 | -40（跳过） | 事体禁忌七曜匹配 |
| 宝日 | +25 | 戊己日 |
| 义日 | +15 | 丙丁日 |
| 专日 | +15 | 壬癸日 |
| 伐日 | -30（跳过） | 甲乙日 |
| 臣犯君 | -35（跳过） | 日干克岁干 |
| **最终推荐** | **≥70分** | **仅显示70分以上** |

### 使用流程

```
用户选择事体（如“嫁娶纳妓”）
     ↓
设定搜索范围（未来30天/60天）
     ↓
逐日计算：日禽 → 七曜类型 → 日干 → 宝义专日
     ↓
综合评分：七曜适配 + 宝义专日评级 + 臣犯君检查
     ↓
排除凶日：伐日、臣犯君、七曜禁忌
     ↓
按分数降序排列，展示吉日列表
```

### 支持的事体类型

1. 嫁娶纳妓
2. 埋葬安葬
3. 求名考试
4. 上官赴任
5. 征伐捕盗
6. 行商贸易
7. 造宅修建
8. 祈福祭祀

---

## 9. 演算链路说明

### 走失演禽核心流程

```
用户输入：日期 + 时辰 + 象类（走失对象）
     ↓
1. 日禽计算：日期 → 七元甲子算法 → 日禽（值日星宿）
     ↓
2. 时禽计算：日禽属性 + 时辰 → 时禽
     ↓
3. 用神定位：象类 → 查 lost_items_config.json → 用神星宿
     ↓
4. 落宫计算：(用神索引 - 日禽索引 + 时辰索引) % 12 → 地支
     ↓
5. 断语查询：{用神}在{地支} → 查 lost_items_rules.json → 断语
     ↓
输出：方位、距离、环境、报信人、时间提示
```

---

## 7. 扩展规划

### 6.1 演禽盘式（待实现）

演禽盘式需要同时计算并展示：
- **本禽**（日禽）
- **身禽**（时禽）
- **用禽**（用神）
- **应禽**（翻禽）
- **变禽**（活曜）

### 6.2 禽星锁泊十二宫（待实现）

将计算出的星宿安入十二宫位，判断：
- 生克关系
- 宫位吉凶
- 动静虚实

### 6.3 二十八宿用事规则（规划中）

- 规则来源：`规则/二十八宿诸禽断诀.md`
- 数据形态：计划以 ArkTS 工具类 `StarEventRulesUtils.ets` + 轻量配置方式承载，避免额外 JSON 体积压力
- 规则内容：按具体星宿 × 具体事体（嫁娶、造葬、求财、出行、上官等）给出吉/平/忌的等级与简要原因
- 应用场景：为智能择日助手与演禽造葬页面提供“星宿级微调”提示，与七曜总断和宝义专日形成三层规则体系

---

## 8. 开发备注

### 数据来源
- 起年禽诀、起月禽诀、起日禽诀、起时禽诀 → `yanqin_star_rules.json`
- 《鬼谷子二十八宿演禽走失全书歌》 → `lost_items_config.json`
- 《孙伯陵秘传走失神书》/《规则.md》 → `lost_items_rules.json`

### 注意事项
1. **日禽**是演禽术的核心，必须使用七元甲子算法，不能简单用28天循环
2. 所有规则数据外置为 JSON，代码中不硬编码
3. 万年历数据不含值日星宿字段，需通过算法计算

---

